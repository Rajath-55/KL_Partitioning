cscope 15 $HOME/Desktop/all/SAT/CPP_Code               0000033911
	@Header.hpp

1 #i‚de‡
Hódî_h


2 
	#Hódî_h


	)

5 
	~<°dio.h
>

6 
	~<°dlib.h
>

7 
	~"io°ªam
"

8 
	~"f°ªam
"

9 
	~<time.h
>

10 
	~<°rög.h
>

11 
	~<m©h.h
>

12 
	~<limôs.h
>

14 
usög
 
«me•a˚
 
	g°d
;

16 
	#MAX
 1000000

	)

17 
	#Lambda
 2

18 
	#WEIGHT
 1.0

	)

19 **
ßve_∑πôi⁄
;

20 *
£ed_vÆue
;

22 
	gq
=0;

23 
	svútuÆ_addªss


25 *
	mrow
,*
	mcﬁum
;

26 } 
	gaddªss
;

28 
	gInô_comm_cut_co°
=0,
	gInô_powbÆ
=0, 
	gwt
=
WEIGHT
,
	gwt1
=WEIGHT;

34 
øndom_∑πôi⁄
(*
c‹e_id
, 
n
,
ödx
, ** 
∑πôi⁄
);

35 
KL
(
ödx
, **
gøph
,*
c‹e_id
, 
n
,**
∑πôi⁄
);

36 
∑πôi⁄_co°
(**
gøph
, *
A
, *
B
, 
n
);

38 
KL_∑πôi⁄
(
ödx
,**
gøph
, 
n
, *
c‹e_id
,*
föÆ_∑πôi⁄_c‹e
);

39 
Êù
(**
G
,*
föÆ_∑πôi⁄_c‹e
,
k
,
t
,
nodes
,
loˇl
);

40 
ôî©ive_im¥ovemít
(**
G
, *
föÆ_∑πôi⁄_c‹e
,
nodes
, 
loˇl
);

41 
diff
(, );

42 
H›s
(,,);

43 
¥öt_gøph
(**
gøph
);

59 
	$KL_∑πôi⁄
(
ödx
,**
gøph
, 
n
, *
c‹e_id
,*
föÆ_∑πôi⁄_c‹e
)

61 
i
,
j
;

62 
be°_co°
=
INT_MAX
,
cut
;

66 i‡(
n
<=
Lambda
)

68 
i
=0;i<
Lambda
;i++)

70 
föÆ_∑πôi⁄_c‹e
[
q
++]=
c‹e_id
[
i
];

75 **
∑πôi⁄
,**
be°_∑πôi⁄
;

77 
∑πôi⁄
=(**)
	`mÆloc
(2*(*));

78 
∑πôi⁄
[0]=(*)
	`mÆloc
(
n
/2 * ());

79 
∑πôi⁄
[1]=(*)
	`mÆloc
(
n
/2 * ());

81 
be°_∑πôi⁄
=(**)
	`mÆloc
(2*(*));

82 
be°_∑πôi⁄
[0]=(*)
	`mÆloc
(
n
/2 * ());

83 
be°_∑πôi⁄
[1]=(*)
	`mÆloc
(
n
/2 * ());

85 
i
=0;i<
n
/4;i++)

88 
	`KL
(
ödx
,
gøph
,
c‹e_id
,
n
,
∑πôi⁄
);

90 
cut
=
	`∑πôi⁄_co°
(
gøph
, 
∑πôi⁄
[0],Ö¨tôi⁄[1],
n
/2);

91 if(
cut
<
be°_co°
)

93 
be°_co°
=
cut
;

94 
j
=0;j<
n
/2;j++)

96 
be°_∑πôi⁄
[0][
j
]=
∑πôi⁄
[0][j];

97 
be°_∑πôi⁄
[1][
j
]=
∑πôi⁄
[1][j];

102 
	`‰ì
(
∑πôi⁄
);

105 
	`KL_∑πôi⁄
(
ödx
,
gøph
, 
n
/2, 
be°_∑πôi⁄
[0],
föÆ_∑πôi⁄_c‹e
);

106 
	`KL_∑πôi⁄
(
ödx
,
gøph
, 
n
/2, 
be°_∑πôi⁄
[1],
föÆ_∑πôi⁄_c‹e
);

107 
	`‰ì
(
be°_∑πôi⁄
);

110 
	}
}

122 
	$øndom_∑πôi⁄
(*
c‹e_id
, 
n
, 
ödx
, **
∑πôi⁄
)

124 
i
,
j
,
k
,
r
;

126 
j
=0;

127 
k
=0;

128 
	`§™d
(
£ed_vÆue
[
ödx
]);

129 
i
=0;i<
n
;i++)

131 
r
 = 
	`ønd
();

133 i‡((
r
 % 2 ) == 0) {

134 i‡(
j
 < 
n
/2)

136 
∑πôi⁄
[0][
j
] = 
c‹e_id
[
i
];

137 
j
++;

141 
∑πôi⁄
[1][
k
] = 
c‹e_id
[
i
];

142 
k
++;

146 i‡(
k
 < 
n
/2)

148 
∑πôi⁄
[1][
k
] = 
c‹e_id
[
i
];

149 
k
++;

153 
∑πôi⁄
[0][
j
] = 
c‹e_id
[
i
];

154 
j
++;

172 
	}
}

186 
	$KL
(
ödx
, **
gøph
,*
c‹e_id
, 
n
,**
∑πôi⁄
)

188 
i
,
j
,
k
,
r
;

195 
	`øndom_∑πôi⁄
(
c‹e_id
, 
n
,
ödx
, 
∑πôi⁄
);

198 *
ãmp_a
, *
ãmp_b
, 
cou¡î
, 
I
, 
J
, 
sw≠_a
, 
sw≠_b
;

199 
Ia
, 
Ib
, 
Ea
, 
Eb
, 
Pow_a
, 
Pow_b
, *
Da
, *
Db
, 
gaö
,
ãmp
, *
Gaö_k
, *
Sum_Gaö_k
, 
max
;

201 
ãmp_a
=(*)
	`mÆloc
(
n
/2 * ());

202 
ãmp_b
=(*)
	`mÆloc
(
n
/2 * ());

204 
Da
=(*)
	`mÆloc
(
n
/2 * ());

205 
Db
=(*)
	`mÆloc
(
n
/2 * ());

207 
Gaö_k
=(*)
	`mÆloc
(
n
/2 * ());

208 
Sum_Gaö_k
=(*)
	`mÆloc
(
n
/2 * ());

210 
i
=0;i<
n
/2;i++)

212 
ãmp_a
[
i
]=
∑πôi⁄
[0][i];

213 
ãmp_b
[
i
]=
∑πôi⁄
[1][i];

216 
Êag
=0;

217 
ﬁd_max
=
INT_MAX
;

219 if(
Inô_comm_cut_co°
==0)

221 
Inô_comm_cut_co°
=
	`∑πôi⁄_co°
(
gøph
,
ãmp_a
,
ãmp_b
,
n
/2);

229 
cou¡î
=0;

236 
cou¡î
<
n
/2)

239 
j
=
cou¡î
;j<
n
/2;j++)

241 
Ia
=0.0;

242 
Ea
=0.0;

245 
Ib
=0.0;

246 
Eb
=0.0;

249 
i
=0;i<
n
/2;i++)

251 
Ia
+=
gøph
[
ãmp_a
[
j
]][ãmp_a[
i
]];

252 
Ea
+=
gøph
[
ãmp_a
[
j
]][
ãmp_b
[
i
]];

255 
Ib
+=
gøph
[
ãmp_b
[
j
]][ãmp_b[
i
]];

256 
Eb
+=
gøph
[
ãmp_b
[
j
]][
ãmp_a
[
i
]];

259 
Da
[
j
]=
Ea
-
Ia
;

260 
Db
[
j
]=
Eb
-
Ib
;

266 
gaö
=-1.0*
INT_MAX
;

269 
i
=
cou¡î
;i<
n
/2;i++)

271 
j
=
cou¡î
;j<
n
/2;j++)

274 
ãmp
=(
Da
[
i
]+
Db
[
j
]-
gøph
[
ãmp_a
[i]][
ãmp_b
[j]]-gøph[ãmp_b[j]][ãmp_a[i]])/
Inô_comm_cut_co°
 ;

276 if(
ãmp
>
gaö
)

278 
gaö
=
ãmp
;

279 
I
=
i
;

280 
J
=
j
;

286 
Gaö_k
[
cou¡î
++]=
gaö
;

287 
sw≠_a
=
ãmp_a
[
I
];

288 
sw≠_b
=
ãmp_b
[
J
];

292 
i
=
I
;i>=
cou¡î
;i--)

295 
ãmp_a
[
i
]=temp_a[i-1];

298 
ãmp_a
[
cou¡î
-1]=
sw≠_b
;

300 
i
=
J
;i>=
cou¡î
;i--)

303 
ãmp_b
[
i
]=temp_b[i-1];

306 
ãmp_b
[
cou¡î
-1]=
sw≠_a
;

311 
i
=0;i<
cou¡î
;i++)

313 
Sum_Gaö_k
[
i
]=0.0;

314 
j
=
i
;j>=0;j--)

316 
Sum_Gaö_k
[
i
]+=
Gaö_k
[
j
];

322 
max
=
Sum_Gaö_k
[0];

323 
k
=0;

324 
i
=0;i<
cou¡î
;i++)

326 if(
Sum_Gaö_k
[
i
]>
max
)

328 
max
=
Sum_Gaö_k
[
i
];

329 
k
=
i
;

336 
i
=0;i<=
k
;i++)

338 
j
=0;j<
n
/2;j++)

340 if(
ãmp_b
[
i
]==
∑πôi⁄
[0][
j
])

342 
∑πôi⁄
[0][
j
]=
ãmp_a
[
i
];

345 if(
ãmp_a
[
i
]==
∑πôi⁄
[1][
j
])

347 
∑πôi⁄
[1][
j
]=
ãmp_b
[
i
];

353 
i
=0;i<
n
/2;i++)

355 
ãmp_a
[
i
]=
∑πôi⁄
[0][i];

356 
ãmp_b
[
i
]=
∑πôi⁄
[1][i];

358 i‡(
Êag
==1)

360 
	`‰ì
(
ãmp_a
);

361 
	`‰ì
(
ãmp_b
);

362 
	`‰ì
(
Gaö_k
);

363 
	`‰ì
(
Sum_Gaö_k
);

364 
	`‰ì
(
Da
);

365 
	`‰ì
(
Db
);

369 if(
ﬁd_max
<=
max
)

371 
Êag
=1;

373 
ﬁd_max
=
max
;

375 }
max
>=0 && 
k
<(
n
/2-1));

377 
	`‰ì
(
ãmp_a
);

378 
	`‰ì
(
ãmp_b
);

379 
	`‰ì
(
Gaö_k
);

380 
	`‰ì
(
Sum_Gaö_k
);

381 
	`‰ì
(
Da
);

382 
	`‰ì
(
Db
);

384 
	}
}

397 
	$∑πôi⁄_co°
(**
gøph
, *
A
, *
B
, 
n
)

399 
cut
=0.0;

400 
i
,
j
;

401 
i
=0;i<
n
;i++)

403 
j
=0;j<
n
;j++)

405 
cut
+=
gøph
[
A
[
i
]][
B
[
j
]];

410  
cut
;

411 
	}
}

428 
	$co°_loˇl
(*
m≠
,**
G
, 
n
,
°¨t
, 
íd
)

430 
ödex1
,
ödex2
;

431 
co°
=0;

432 
ödex1
=
°¨t
;ödex1<
íd
;index1++)

434 
ödex2
=
ödex1
+1;ödex2<
íd
;index2++)

436 if(
G
[
m≠
[
ödex1
]][m≠[
ödex2
]]!=
MAX
 && G[map[index1]][map[index2]]!=0)

438 if(
G
[
m≠
[
ödex1
]][m≠[
ödex2
]]==G[map[index2]][map[index1]])

440 
co°
=co°+()
	`H›s
(
ödex1
,
ödex2
,
n
)*
G
[
m≠
[index1]][map[index2]];

445 
co°
=co°+()
	`H›s
(
ödex1
,
ödex2
,
n
)*
G
[
m≠
[index1]][map[index2]];

446 
co°
=co°+()
	`H›s
(
ödex1
,
ödex2
,
n
)*
G
[
m≠
[index2]][map[index1]];

452 
	`¥ötf
("I¿co°Üoˇ»: co° = %.6f\n", 
co°
);

453  
co°
;

455 
	}
}

466 
	$co°
(*
m≠
,**
G
, 
n
)

468 
ödex1
,
ödex2
;

469 
co°
=0;

470 
ödex1
=0;ödex1<
n
;index1++)

472 
ödex2
=
ödex1
+1;ödex2<
n
;index2++)

474 if(
G
[
m≠
[
ödex1
]][m≠[
ödex2
]]!=
MAX
 && G[map[index1]][map[index2]]!=0)

476 if(
G
[
m≠
[
ödex1
]][m≠[
ödex2
]]==G[map[index2]][map[index1]])

478 
co°
=co°+()
	`H›s
(
ödex1
,
ödex2
,
n
)*
G
[
m≠
[index1]][map[index2]];

483 
co°
=co°+()
	`H›s
(
ödex1
,
ödex2
,
n
)*
G
[
m≠
[index1]][map[index2]];

484 
co°
=co°+()
	`H›s
(
ödex2
,
ödex1
,
n
)*
G
[
m≠
[index2]][map[index1]];

489 
	`¥ötf
("I¿co° globÆ : co° = %.6f\n", 
co°
);

490  
co°
;

491 
	}
}

502 
	$co°_cc
(*
m≠
,**
G
, 
n
)

504 
ödex1
,
ödex2
;

505 
co°
=0;

506 
ödex1
=0;ödex1<
n
;index1++)

508 
ödex2
=
ödex1
+1;ödex2<
n
;index2++)

510 if(
G
[
m≠
[
ödex1
]][m≠[
ödex2
]]!=
MAX
 && G[map[index1]][map[index2]]!=0)

512 if(
G
[
m≠
[
ödex1
]][m≠[
ödex2
]]==G[map[index2]][map[index1]])

514 
co°
=co°+()(
	`H›s
(
ödex1
,
ödex2
,
n
)+1)*2*
G
[
m≠
[index1]][map[index2]];

519 
co°
=co°+()(
	`H›s
(
ödex1
,
ödex2
,
n
)+1)*2*
G
[
m≠
[index1]][map[index2]];

520 
co°
=co°+()(
	`H›s
(
ödex1
,
ödex2
,
n
)+1)*2*
G
[
m≠
[index2]][map[index1]];

525  
co°
;

526 
	}
}

537 
	$H›s
(
¢ode
,
dnode
,
n
)

539 
h›_cou¡
;

540 
h›_cou¡
 = 
	`abs
(
addªss
.
row
[
¢ode
]-addªss.row[
dnode
]Ë+ábs◊ddªss.
cﬁum
[snode]-address.colum[dnode]);

541  
h›_cou¡
;

542 
	}
}

545 
	$diff
(
fú°
, 
£c⁄d
)

547 
dif
;

548 
dif
 = 
	`abs
(
fú°
-
£c⁄d
);

549  
dif
;

550 
	}
}

552 
	$¥öt_gøph
(**
gøph
, 
num_nodes
)

554 
i
 = 0, 
j
 = 0;

556 
i
 = 0; i < 
num_nodes
; ++i){

557 
j
 = 0; j < 
num_nodes
; ++j){

558 
cout
 << 
gøph
[
i
][
j
] <<" ";

560 
cout
<<"\n";

565 
	}
}

	@optical.c

1 
	~"gøph.h
"

2 
	~<°dio.h
>

3 
	~<°dlib.h
>

4 
gøph_öfo
 
Gr
;

5 
edge_öfo
 *
edges
;

6 
	$ªad_powîloss
(**
powîloss
, 
gøph_numbî
)

8 
i
,
j
;

9 
FILE
 *
±r
;

15 if(
gøph_numbî
 == 1)

17 
±r
 = 
	`f›í
( "powerloss/cruxrouter/appGraph1_loss.txt","r");

19 i‡(
gøph_numbî
 == 2)

21 
±r
 = 
	`f›í
( "powerloss/cruxrouter/appGraph2_loss.txt","r");

23 i‡(
gøph_numbî
 == 3)

25 
±r
 = 
	`f›í
( "powerloss/cruxrouter/appGraph3_loss.txt","r");

27 i‡(
gøph_numbî
 == 4)

29 
±r
 = 
	`f›í
( "powerloss/cruxrouter/appGraph4_loss.txt","r");

31 i‡(
gøph_numbî
 == 5)

33 
±r
 = 
	`f›í
( "/home/sucharita/constructive_heuristics_optical/powerloss/cruxrouter/appGraph5_loss.txt","r");

35 i‡(
gøph_numbî
 == 6)

37 
±r
 = 
	`f›í
( "/home/sucharita/constructive_heuristics_optical/powerloss/cruxrouter/appGraph6_loss.txt","r");

39 i‡(
gøph_numbî
 == 7)

41 
±r
 = 
	`f›í
( "/home/sucharita/constructive_heuristics_optical/powerloss/cruxrouter/appGraph7_loss.txt","r");

43 i‡(
gøph_numbî
 == 8)

45 
±r
 = 
	`f›í
( "/home/sucharita/constructive_heuristics_optical/powerloss/cruxrouter/appGraph8_loss.txt","r");

47 i‡(
gøph_numbî
 == 9)

49 
±r
 = 
	`f›í
( "/home/sucharita/constructive_heuristics_optical/powerloss/cruxrouter/appGraph9_loss.txt","r");

51 i‡(
gøph_numbî
 == 10)

53 
±r
 = 
	`f›í
( "/home/sucharita/constructive_heuristics_optical/powerloss/cruxrouter/appGraph10_loss.txt","r");

55 i‡(
gøph_numbî
 == 13)

57 
±r
 = 
	`f›í
( "/home/sucharita/constructive_heuristics_optical/powerloss/cruxrouter/appGraph13_loss.txt","r");

59 i‡(
gøph_numbî
 == 14)

61 
±r
 = 
	`f›í
( "/home/sucharita/constructive_heuristics_optical/powerloss/cruxrouter/appGraph14_loss.txt","r");

63 i‡(
gøph_numbî
 == 15)

65 
±r
 = 
	`f›í
( "/home/sucharita/constructive_heuristics_optical/powerloss/cruxrouter/appGraph15_loss.txt","r");

67 i‡(
gøph_numbî
 == 17)

69 
±r
 = 
	`f›í
( "powerloss/cruxrouter/appGraph17_loss.txt","r");

71 i‡(
gøph_numbî
 == 18)

73 
±r
 = 
	`f›í
( "/home/sucharita/constructive_heuristics_optical/powerloss/cruxrouter/appGraph18_loss.txt","r");

75 i‡(
gøph_numbî
 == 19)

77 
±r
 = 
	`f›í
( "/home/sucharita/constructive_heuristics_optical/powerloss/cruxrouter/appGraph19_loss.txt","r");

79 i‡(
gøph_numbî
 == 20)

81 
±r
 = 
	`f›í
( "/home/sucharita/constructive_heuristics_optical/powerloss/cruxrouter/appGraph20_loss.txt","r");

83 i‡(
gøph_numbî
 == 21)

85 
±r
 = 
	`f›í
( "/home/sucharita/constructive_heuristics_optical/powerloss/cruxrouter/appGraph21_loss.txt","r");

87 i‡(
gøph_numbî
 == 22)

89 
±r
 = 
	`f›í
( "/home/sucharita/constructive_heuristics_optical/powerloss/cruxrouter/appGraph22_loss.txt","r");

91 i‡(
gøph_numbî
 == 23)

93 
±r
 = 
	`f›í
( "/home/sucharita/constructive_heuristics_optical/powerloss/cruxrouter/appGraph23_loss.txt","r");

95 i‡(
gøph_numbî
 == 25)

97 
±r
 = 
	`f›í
( "powerloss/cruxrouter/appGraph25_loss.txt","r");

99 i‡(
gøph_numbî
 == 26)

101 
±r
 = 
	`f›í
( "powerloss/cruxrouter/appGraph26_loss.txt","r");

103 i‡(
gøph_numbî
 == 27)

105 
±r
 = 
	`f›í
( "powerloss/cruxrouter/appGraph27_loss.txt","r");

107 i‡(
gøph_numbî
 == 28)

109 
±r
 = 
	`f›í
( "/home/sucharita/constructive_heuristics_optical/powerloss/cruxrouter/appGraph28_loss.txt","r");

111 i‡(
gøph_numbî
 == 29)

113 
±r
 = 
	`f›í
( "/home/sucharita/constructive_heuristics_optical/powerloss/cruxrouter/appGraph29_loss.txt","r");

115 i‡(
gøph_numbî
 == 30)

117 
±r
 = 
	`f›í
( "powerloss/cruxrouter/appGraph30_loss.txt","r");

120 if(
±r
 =
NULL
)

122 
	`¥ötf
("file can't be opened \n");

126 
i
 = 0; i<
Gr
.
rows
*Gr.
cﬁums
; i++)

128 
j
 = 0;j<
Gr
.
rows
*Gr.
cﬁums
; j++)

130 
	`fsˇnf
(
±r
,"%lf\t",&
powîloss
[
i
][
j
]);

143 
	`f˛o£
(
±r
);

145 
	}
}

146 
	$evÆu©ePowîLoss
(*
m≠pög
, **
powîlossm©rix
)

148 
loss
,
loss_wc
 = 0;

149 *
öv_m≠
 = 
√w
 [
Gr
.
nodes
];

150 
i
 = 0;i<
Gr
.
nodes
;i++)

152 
öv_m≠
[
m≠pög
[
i
]] = i;

154 
i
 = 0;i<
Gr
.
edges
;i++)

156 
èsk_i
 = 
edges
[
i
].
de°ö©i⁄
 ;

157 
èsk_j

edges
[
i
].
sour˚
 ;

159 
m≠p_c‹e_èsk_i
 = 
öv_m≠
[
èsk_i
];

160 
m≠p_c‹e_èsk_j
 = 
öv_m≠
[
èsk_j
];

173 
loss
 = 
powîlossm©rix
[
m≠p_c‹e_èsk_i
][
m≠p_c‹e_èsk_j
];

177 i‡(
loss
 < 
loss_wc
)

179 
loss_wc
 = 
loss
;

180 
sour˚èskwc
 = 
m≠p_c‹e_èsk_i
 ;

181 
de°ö©i⁄èskwc
 = 
m≠p_c‹e_èsk_j
;

186  
loss_wc
;

188 
	}
}

	@optical.hpp

1 #i‚de‡
›tiˇl_h


2 
	#›tiˇl_h


	)

4 
ªad_powîloss
(**
powîloss
, 
gøph_numbî
);

5 
evÆu©ePowîLoss
(*
m≠pög
, **
powîlossm©rix
);

	@opticalKL.cpp

12 
	~"Hódî.hµ
"

13 
	~<iom™ù
>

15 
	#TILE_WIDTH
 0.0025

16 
	#TILE_HEIGHT
 0.0025

17 
	#NO_OF_RUN
 1

	)

21 **
	ga
;

22 
	gco°_be°
 = 99999999;

23 **
	gßve_∑πôi⁄
;

24 *
	g£ed_vÆue
;

25 
	sgøph_öfo
 {

26 
	mNo_nodes
;

27 
	ma˘uÆ_No_nodes
;

28 
	mrows
;

29 
	mcﬁums
;

30 
	medges
;

32 } 
	gGøph_öf
;

34 
	scommodôy
 {

35 
	mvÆue
;

36 
	msour˚
;

37 
	mde°ö©i⁄
;

46 
≥rf‹m_KL
(*
¨gv
[], **
√éi°
, *
ouçut
);

47 
m≠_nodes
(
nodes
, *
föÆ_∑πôi⁄_c‹e
, **
gøph
);

71 **
	$Ród_gøph
(*
«me
, *
di°
) {

72 **
√éi°
;

73 
i
, 
j
, 
row
, 
co
, 
cou¡
, 
n1
, 
n4
, 
nodes
, 
a˘uÆ_no_of_nodes
;

74 
z
, 
n2
, 
n3
;

75 
buff
[20];

76 
f°ªam
 
Â1
;

77 
Â1
.
	`›í
(
«me
, 
ios
::
ö
);

79 
Â1
 >> 
nodes
;

80 
Â1
 >> 
buff
;

82 
Gøph_öf
.
a˘uÆ_No_nodes
 = 
a˘uÆ_no_of_nodes
 = 
nodes
;

83 
Gøph_öf
.
edges
 = 0;

85 
n2
 = 
	`log
(()
nodes
) /Üog(2.0);

86 
n1
 = ()
n2
;

87 
	`¥ötf
("%d %‡a˘uÆÇode†%d", 
n1
, 
n2
, 
nodes
);

88 i‡(
n2
 > ()
n1
) {

89 
	`¥ötf
("\n\t\tAdding dummyÇodes\n");

90 
n3
 = 
	`pow
(2.0, 
n1
 + 1);

91 
nodes
 = ()
n3
;

92 
	`¥ötf
("\nö˛udög dummyÇodes%d\n", 
nodes
);

95 
row
 = 0;

96 
co
 = 0;

97 
cou¡
 = 0;

98 
√éi°
 = (**)
	`mÆloc
(
nodes
 * (*));

99 
i
 = 0; i < 
nodes
; i++)

100 
√éi°
[
i
] = (*)
	`mÆloc
(
nodes
 * ());

102 
cou¡
 < 
a˘uÆ_no_of_nodes
 *áctual_no_of_nodes) {

104 
z
 = 
	`©of
(
buff
);

105 i‡(!
	`°rcmp
(
buff
, "INF"))

106 
z
 = 0;

107 
cou¡
++;

109 i‡(
co
 < 
a˘uÆ_no_of_nodes
) {

110 
√éi°
[
row
][
co
++] = 
z
;

112 
co
 = 0;

113 
row
++;

115 
√éi°
[
row
][
co
++] = 
z
;

117 
Â1
 >> 
buff
;

120 
ãmp_pow
 = 
	`log
(
nodes
) /Üog(2.0);

121 
•lô1
, 
•lô2
;

122 
•lô1
 = 
	`Êo‹
(
ãmp_pow
 / 2.0);

123 
•lô2
 = 
	`˚û
(
ãmp_pow
 / 2.0);

124 
Gøph_öf
.
No_nodes
 = 
nodes
;

125 
Gøph_öf
.
rows
 = ()
	`pow
(2, 
•lô1
);

126 
Gøph_öf
.
cﬁums
 = ()
	`pow
(2, 
•lô2
);

128 
cout
 << "\nRow†" << 
Gøph_öf
.
rows
 << "\nCﬁ†" << Gøph_öf.
cﬁums
 << "\n";

129 
Â1
.
	`˛o£
();

130 
di°ri
 = 
	`©oi
(
di°
);

132 i‡(
n2
 > ()
n1
 && 
di°ri
 == 1)

135 
i
 = 
a˘uÆ_no_of_nodes
; i < 
nodes
; i++) {

136 
j
 = 0; j < 
nodes
; j++) {

137 i‡(
j
 >
a˘uÆ_no_of_nodes
)

138 
√éi°
[
i
][
j
] = 0;

140 
√éi°
[
i
][
j
] = 0;

144 
i
 = 0; i < 
a˘uÆ_no_of_nodes
; i++) {

145 
j
 = 
a˘uÆ_no_of_nodes
; j < 
nodes
; j++) {

146 
√éi°
[
i
][
j
] = 0;

150 
i
 = 0; i < 
nodes
; i++) {

151 
√éi°
[
i
][i] = 0;

156 i‡(
n2
 > ()
n1
) {

157 
i
 = 
a˘uÆ_no_of_nodes
; i < 
nodes
; i++) {

158 
j
 = 0; j < 
nodes
; j++) {

159 i‡(
j
 >
a˘uÆ_no_of_nodes
)

160 
√éi°
[
i
][
j
] = 
MAX
;

162 
√éi°
[
i
][
j
] = 0;

165 
i
 = 0; i < 
a˘uÆ_no_of_nodes
; i++) {

166 
j
 = 
a˘uÆ_no_of_nodes
; j < 
nodes
; j++) {

167 
√éi°
[
i
][
j
] = 0;

170 
i
 = 0; i < 
nodes
; i++) {

171 
√éi°
[
i
][i] = 0;

175 
	`¥öt_gøph
(
√éi°
, 
nodes
);

177  
√éi°
;

178 
	}
}

190 
	$öôülize_add
() {

191 
nodes
 = 
Gøph_öf
.
No_nodes
;

192 
n4
 = (
	`log
(()
nodes
) /Üog(2.0));

193 
n
 = ()
n4
;

194 *
row_add
, *
cﬁ_add
, 
i
, 
j
, 
k
, **
tmp
, 
c
, 
l
;

195 
row_add
 = (*)
	`mÆloc
(
nodes
 * (*));

196 
cﬁ_add
 = (*)
	`mÆloc
(
nodes
 * (*));

198 
tmp
 = (**)
	`mÆloc
((
n
 - 1) * (*));

199 
i
 = 0; i < 
n
 - 1; i++)

200 
tmp
[
i
] = (*)
	`mÆloc
(
nodes
 * ());

203 
i
 = 1; i < 
n
; i++) {

204 
c
 = 0;

205 
l
 = 0;

206 
j
 = 0; j < ()
	`pow
(2.0, 
i
); j++) {

207 
k
 = 0; k < ()
	`pow
(2.0, 
n
 - 
i
); k++)

208 
tmp
[
i
 - 1][
l
++] = 
c
;

209 
c
++;

215 
i
 = 0; i < 
nodes
; i = i + 4) {

216 
row_add
[
i
] = 
cﬁ_add
[i] =Ñow_add[i + 1] = col_add[i + 2] = 0;

217 
cﬁ_add
[
i
 + 1] = 
row_add
[i + 2] = col_add[i + 3] =Ñow_add[i + 3] = 1;

221 
cou¡
, 
xyz
;

222 
xyz
 = 1;

223 
i
 = 4; i < 
nodes
; i = i * 4) {

224 
cou¡
 = 0;

225 
xyz
 = xyz * 2;

226 
j
 = 0; ((
i
 * 
cou¡
Ë< 
nodes
); j++) {

227 
j
 = j % 4;

228 
k
 = 0; ((k < 
i
Ë&& ((ò* 
cou¡
 + kË< 
nodes
)); k++) {

229 i‡((
j
 == 2) || (j == 3))

230 
row_add
[
i
 * 
cou¡
 + 
k
] +
xyz
;

231 i‡((
j
 == 1) || (j == 3))

232 
cﬁ_add
[
i
 * 
cou¡
 + 
k
] +
xyz
;

234 
cou¡
++;

239 
addªss
.
cﬁum
 = 
cﬁ_add
;

240 
addªss
.
row
 = 
row_add
;

241 
a
 = 
tmp
;

242 
	}
}

261 
	$maö
(
¨gc
, *
¨gv
[]) {

262 
time_t
 
t
;

263 
	`time
(&
t
);

264 
	`§™d
(
t
);

265 i‡(
¨gc
 < 1) {

267 
	`¥ötf
("\t\t\t\t\tNO INPUT GRAPH orÇo. of cuts\n\n");

268 
	`exô
(0);

270 
f°ªam
 
Âå
, 
Âå1
;

271 
ouçut
[2], **
gøph
;

272 
gøph
 = 
	`Ród_gøph
(
¨gv
[1],árgv[3]);

274 
°r
[30] = "final_";

275 
	`°rˇt
(
°r
, 
¨gv
[1]);

276 
°r1
[30] = "final_comma_";

277 
	`°rˇt
(
°r1
, 
¨gv
[1]);

279 
Âå
.
	`›í
(
°r
, 
ios
::
out
 | ios::
≠p
);

280 
Âå1
.
	`›í
(
°r1
, 
ios
::
out
 | ios::
≠p
);

281 
Âå1
.
	`£tf
(
ios
::
fixed
, ios::
Êﬂtfõld
);

282 
Âå
.
	`£tf
(
ios
::
fixed
, ios::
Êﬂtfõld
);

284 
Âå1
 << "W,CC,Variance,Peak_Temp\n";

292 
ªsu…_èbÀ
[2];

295 
	`öôülize_add
();

296 
no_cuts
 = 
	`©oi
(
¨gv
[2]);

298 
ßve_∑πôi⁄
 = (**)
	`mÆloc
((
no_cuts
) * (*));

299 
£ed_vÆue
 = (*)
	`mÆloc
((
no_cuts
) * ());

301 
j
 = 0; j < 
no_cuts
; j++) {

302 
ßve_∑πôi⁄
[
j
] = (*)
	`mÆloc
((
Gøph_öf
.
No_nodes
) * ());

304 *
c‹e_id
 = 
NULL
;

305 
c‹e_id
 = (*)
	`mÆloc
(
Gøph_öf
.
No_nodes
 * ());

307 **
∑πôi⁄
;

308 
∑πôi⁄
 = (**)
	`mÆloc
(2 * (*));

309 
∑πôi⁄
[0] = (*)
	`mÆloc
(
Gøph_öf
.
No_nodes
 / 2 * ());

310 
∑πôi⁄
[1] = (*)
	`mÆloc
(
Gøph_öf
.
No_nodes
 / 2 * ());

312 
j
 = 0; j < 
Gøph_öf
.
No_nodes
; j++) {

313 
c‹e_id
[
j
] = j;

316 
i
;

317 
Êag
 = 0;

318 
ªsu…_èbÀ
[1] = 999999999;

320 
Êag
 = 0;

322 
k
 = 0; k < 
NO_OF_RUN
; k++) {

323 
Êag
 = 0;

324 
j
 = 0; j < 
no_cuts
; j++) {

325 
£ed_vÆue
[
j
] = 
	`ønd
();

328 
	`≥rf‹m_KL
(
¨gv
, 
gøph
, 
ouçut
);

329 i‡(
ªsu…_èbÀ
[1] > 
ouçut
[1]) {

330 
Êag
 = 1;

332 i‡(
Êag
 == 1) {

333 
ªsu…_èbÀ
[0] = 
ouçut
[0];

334 
ªsu…_èbÀ
[1] = 
ouçut
[1];

337 
cout
 << "\n\n\n\n\nfinished\n\n";

339 
Âå1
 << 
ªsu…_èbÀ
[0]

342 << 
ªsu…_èbÀ
[1] << "\n";

344 
Âå
.
	`˛o£
();

345 
Âå1
.
	`˛o£
();

347 
	}
}

366 
	$≥rf‹m_KL
(*
¨gv
[], **
√éi°
, *
ouçut
) {

368 
˛ock_t
 
t1
, 
t2
;

369 
t1
 = 
	`˛ock
();

371 *
c‹e_id
, 
i
, 
j
, 
k
, 
l
, **
föÆ_∑πôi⁄_c‹e
, 
a˘uÆ_no_of_nodes
, 
nodes
;

373 
°1
[] = "RESULTS628.txt";

374 
°2
[] = "KL2Dmap.txt";

375 
°3
[] = "KL2Dpir.txt";

376 
f°ªam
 
Â
, 
Â1
, 
Â2
;

377 
Â
.
	`›í
(
°1
, 
ios
::
≠p
 | ios::
out
);

378 
Â1
.
	`›í
(
°2
, 
ios
::
≠p
 | ios::
out
);

379 
Â1
.
	`£tf
(
ios
::
fixed
, ios::
Êﬂtfõld
);

380 
Â2
.
	`›í
(
°3
, 
ios
::
≠p
 | ios::
out
);

381 
Â2
.
	`£tf
(
ios
::
fixed
, ios::
Êﬂtfõld
);

384 
nodes
 = 
Gøph_öf
.
No_nodes
;

385 
a˘uÆ_no_of_nodes
 = 
Gøph_öf
.
a˘uÆ_No_nodes
;

386 
di°ri
 = 
	`©oi
(
¨gv
[3]);

387 
c‹e_id
 = (*)
	`mÆloc
(
nodes
 * ());

388 
i
 = 0; i < 
nodes
; i++) {

389 
c‹e_id
[
i
] = i;

392 
comm_co°
;

393 **
∑πôi⁄
, 
öô
;

394 
∑πôi⁄
 = (**)
	`mÆloc
(2 * (*));

395 
∑πôi⁄
[0] = (*)
	`mÆloc
(
nodes
 / 2 * ());

396 
∑πôi⁄
[1] = (*)
	`mÆloc
(
nodes
 / 2 * ());

398 
öô
 = 
	`©oi
(
¨gv
[2]);

407 
föÆ_∑πôi⁄_c‹e
 = (**)
	`mÆloc
(
öô
 * (*));

408 
i
 = 0; i < 
öô
; i++)

409 
föÆ_∑πôi⁄_c‹e
[
i
] = (*)
	`mÆloc
(
nodes
 * ());

411 
øsk
;

413 
i
 = 0; i < 
öô
; i++) {

415 
Inô_comm_cut_co°
 = 0;

416 
Inô_powbÆ
 = 0;

417 
	`KL
(
i
, 
√éi°
, 
c‹e_id
, 
nodes
, 
∑πôi⁄
);

419 
	`KL_∑πôi⁄
(
i
, 
√éi°
, 
nodes
 / 2, 
∑πôi⁄
[0], 
föÆ_∑πôi⁄_c‹e
[i]);

420 
	`KL_∑πôi⁄
(
i
, 
√éi°
, 
nodes
 / 2, 
∑πôi⁄
[1], 
föÆ_∑πôi⁄_c‹e
[i]);

421 
q
 = 0;

422 
øsk
 = 
	`co°
(
föÆ_∑πôi⁄_c‹e
[
i
], 
√éi°
, 
nodes
);

424 
j
 = 0; j < 
nodes
; j = j + 2) {

425 
Â
 << 
föÆ_∑πôi⁄_c‹e
[
i
][
j
] + 1 << " "

426 << 
föÆ_∑πôi⁄_c‹e
[
i
][
j
 + 1] + 1 << "\t";

428 
Â
 << "\n" << 
i
 << "\n" << 
øsk
 << "\n\n";

431 
be°_co°
, 
ãmp
, *
co°_f
;

432 
co°_f
 = 
√w
 [
öô
];

433 
be°
 = 0;

435 
be°_co°
 = 999999999;

437 
i
 = 0; i < 
öô
; i++) {

438 
co°_f
[
i
] = 
	`m≠_nodes
(
nodes
, 
föÆ_∑πôi⁄_c‹e
[i], 
√éi°
);

441 
cout
.
	`£tf
(
ios
::
fixed
, ios::
Êﬂtfõld
);

442 
Â
.
	`£tf
(
ios
::
fixed
, ios::
Êﬂtfõld
);

444 i‡(
di°ri
 == 1) {

445 
Â
 << "\n"

446 << "Di°ributive\t" << 
¨gv
[1]

447 << "\äo. o‡c‹es" << 
a˘uÆ_no_of_nodes
 << "\äo. o‡cut†" << 
öô
;

448 
Â
 << "\n";

449 
cout
 << "\n"

450 << "Di°ributive\t" << 
¨gv
[1]

451 << "\äo. o‡c‹es" << 
a˘uÆ_no_of_nodes
;

452 
cout
 << "\n";

454 
Â
 << "\n"

455 << 
¨gv
[1] << "\äo. o‡c‹es" << 
a˘uÆ_no_of_nodes


456 << "\äo. o‡cut†" << 
öô
;

457 
Â
 << "\n";

458 
cout
 << "\n" << 
¨gv
[1] << "\äo. o‡c‹es" << 
a˘uÆ_no_of_nodes
;

459 
cout
 << "\n";

462 
j
 = 0; j < 
öô
; j++) {

463 
i
 = 0; i < 
nodes
; i = i + 2) {

464 
cout
 << 
föÆ_∑πôi⁄_c‹e
[
j
][
i
] + 1 << " "

465 << 
föÆ_∑πôi⁄_c‹e
[
j
][
i
 + 1] + 1 << "\t";

466 
Â
 << 
föÆ_∑πôi⁄_c‹e
[
j
][
i
] + 1 << " "

467 << 
föÆ_∑πôi⁄_c‹e
[
j
][
i
 + 1] + 1 << "\t";

469 
co°_f
[
j
] = 
	`co°
(
föÆ_∑πôi⁄_c‹e
[j], 
√éi°
, 
nodes
);

470 
ãmp
 = 
co°_f
[
j
];

471 i‡(
ãmp
 < 
be°_co°
) {

472 
be°_co°
 = 
ãmp
;

473 
be°
 = 
j
;

476 
Â
 << "\n" << 
j
 << "\n" << 
co°_f
[j] << "\n\n";

479 
Â
 << "\n\n***** be° co°=" << ()
co°_f
[
be°
] << "\nbest =" << best;

481 
cout
 << "\n\n***** be° co°=*****" << 
co°_f
[
be°
] << "\n";

482 
ouçut
[0] = 
	`co°
(
föÆ_∑πôi⁄_c‹e
[
be°
], 
√éi°
, 
nodes
);

483 
cout
 << "\¿co° i¿CC : " << 
ouçut
[0];

484 
ouçut
[1] = 
co°_f
[
be°
];

492 
cout
 << "\n\n\n*************\n"

493 << 
Gøph_öf
.
No_nodes
 << "\t" << Gøph_öf.
rows
 << "\t"

494 << 
Gøph_öf
.
cﬁums
 << "\n";

495 
t2
 = 
	`˛ock
();

497 
Â1
 << "\n\n" << 
¨gv
[1] << "\n\n";

498 
Â2
 << "\n\n" << 
¨gv
[1] << "\n\n";

499 *
c‹ex
, *
öv_c‹ex
;

500 
n€dges
;

501 
n€dges
 = 0;

502 
c‹ex
 = (*)
	`mÆloc
(
nodes
 * ());

504 
öv_c‹ex
 = (*)
	`mÆloc
(
nodes
 * ());

505 
i
 = 0; i < 
nodes
; i++) {

506 
j
 = 
i
; j < 
nodes
; j++) {

507 i‡((
√éi°
[
i
][
j
] !0Ë&& (√éi°[i][j] !
MAX
))

508 
n€dges
++;

511 
commodôy
 *
D
;

512 
commodôy
 
ãmpx
;

513 
maxvÆ
;

514 
D
 = (
commodôy
 *)
	`mÆloc
(
n€dges
 * (commodity));

515 
n€dges
 = 0;

516 
i
 = 0; i < 
nodes
; i++) {

517 
j
 = 
i
; j < 
nodes
; j++) {

518 i‡((
√éi°
[
i
][
j
] !0Ë&& (√éi°[i][j] !
MAX
)) {

519 
D
[
n€dges
].
vÆue
 = 
√éi°
[
i
][
j
];

520 
D
[
n€dges
].
sour˚
 = 
i
;

521 
D
[
n€dges
].
de°ö©i⁄
 = 
j
;

522 
n€dges
++;

527 
i
 = 0; i < 
n€dges
; i++) {

528 
j
 = 
i
; j < 
n€dges
; j++) {

529 i‡(
D
[
i
].
vÆue
 < D[
j
].value) {

530 
ãmpx
 = 
D
[
i
];

531 
D
[
i
] = D[
j
];

532 
D
[
j
] = 
ãmpx
;

537 
maxvÆ
 = 
D
[0].
vÆue
;

538 *
pú
;

539 
pú
 = (*)
	`mÆloc
(
n€dges
 * ());

540 
i
 = 0; i < 
n€dges
; i++) {

541 
pú
[
i
] = 
D
[i].
vÆue
 / 
maxvÆ
;

549 
i
 = 0; i < 
nodes
; i++) {

550 
c‹ex
[(
addªss
.
row
[
i
] * 
Gøph_öf
.
cﬁums
 +áddªss.
cﬁum
[i])] =

551 
föÆ_∑πôi⁄_c‹e
[
be°
][
i
];

554 
Â1
 << "\nBe° Co° =" << 
be°_co°
 << "\n";

555 
i
 = 0; i < 
nodes
; i++) {

556 
öv_c‹ex
[
c‹ex
[
i
]] = i;

557 
Â1
 << 
i
 << "\t" << 
c‹ex
[i] << "\n";

560 
Â2
 << "\n\nsrc-id\tdst=id\tpir\n";

562 
i
 = 0; i < 
n€dges
; i++) {

563 
Â2
 << 
öv_c‹ex
[
D
[
i
].
sour˚
] << "\t" << inv_c‹ex[D[i].
de°ö©i⁄
] << "\t"

564 << 
pú
[
i
] << "\n";

566 
diff
 = (()(
t2
 - 
t1
)Ë/ 
CLOCKS_PER_SEC
;

567 
Â
 << "\tExecuti⁄ Time: " << 
diff
 << 
ídl
;

568 
cout
 << "Executi⁄ Time: " << 
diff
 << 
ídl
;

570 
cout
 << "\n\n\n\n\nfinished\n\n";

573 
	`‰ì
(
c‹ex
);

574 
Â1
.
	`˛o£
();

575 
Â2
.
	`˛o£
();

576 
	`‰ì
(
∑πôi⁄
);

577 
Â
.
	`˛o£
();

578 
	}
}

596 
	$m≠_nodes
(
nodes
, *
föÆ_∑πôi⁄_c‹e
, **
gøph
) {

598 
i
, 
j
, 
k
;

599 
be°_∑πôi⁄
;

600 
ãmp_co°
;

602 *
ãmp_föÆ_∑πôi⁄_c‹e
;

603 
ãmp_föÆ_∑πôi⁄_c‹e
 = (*)
	`mÆloc
(
nodes
 * (*));

605 
be°_co°
[4], 
GlobÆ_be°
, 
ãmp
;

612 
	`ôî©ive_im¥ovemít
(
gøph
, 
föÆ_∑πôi⁄_c‹e
, 
nodes
,

617 
FöÆ_GlobÆ_be°_co°
 = 
	`co°
(
föÆ_∑πôi⁄_c‹e
, 
gøph
, 
nodes
);

619 
i
 = 0; i < 
nodes
; i++) {

620 
ãmp_föÆ_∑πôi⁄_c‹e
[
i
] = 
föÆ_∑πôi⁄_c‹e
[i];

622 
	`ôî©ive_im¥ovemít
(
gøph
, 
ãmp_föÆ_∑πôi⁄_c‹e
, 
nodes
, 0);

623 
be°_co°
[3] = 
	`co°
(
ãmp_föÆ_∑πôi⁄_c‹e
, 
gøph
, 
nodes
);

624 
be°_co°
[1] = be°_co°[2] = be°_co°[0] = 
MAX
;

627 
	`ôî©ive_im¥ovemít
(
gøph
, 
ãmp_föÆ_∑πôi⁄_c‹e
, 
nodes
, 0);

628 
ãmp
 = 
	`co°
(
ãmp_föÆ_∑πôi⁄_c‹e
, 
gøph
, 
nodes
);

630 i‡(
ãmp
 <
be°_co°
[3]) {

631 
be°_co°
[0] =

632 
be°_co°
[1];

633 
be°_co°
[1] =

634 
be°_co°
[2];

635 
be°_co°
[2] =

636 
be°_co°
[3];

637 
be°_co°
[3] = 
ãmp
;

641 i‡(
ãmp
 =
be°_co°
[3] &&Åemp == best_cost[2] &&Åemp == best_cost[1] &&

642 
ãmp
 =
be°_co°
[0]) {

647 i‡(
FöÆ_GlobÆ_be°_co°
 > 
be°_co°
[3]) {

648 
FöÆ_GlobÆ_be°_co°
 = 
be°_co°
[3];

649 
i
 = 0; i < 
nodes
; i++)

650 
föÆ_∑πôi⁄_c‹e
[
i
] = 
ãmp_föÆ_∑πôi⁄_c‹e
[i];

653 
FöÆ_GlobÆ_be°_co°
 = 
	`co°
(
föÆ_∑πôi⁄_c‹e
, 
gøph
, 
nodes
);

655 
	`‰ì
(
ãmp_föÆ_∑πôi⁄_c‹e
);

656  (
FöÆ_GlobÆ_be°_co°
);

657 
	}
}

676 
	$ôî©ive_im¥ovemít
(**
gøph
, *
föÆ_∑πôi⁄_c‹e
, 
nodes
,

677 
loˇl
) {

678 
n4
 = (
	`log
(()
nodes
) /Üog(2.0));

679 
n
 = ()
n4
;

680 
cuº_lvl
, 
t
, 
w
, 
mö_row
, 
max_row
, 
mö_cﬁ
, 
max_cﬁ
, 
shi·
, 
lo›1
,

681 
be°_∑πôi⁄
;

682 
be°_co°
[4], 
avg_row
, 
avg_cﬁ
, 
dif‰í˚
;

683 
i
, 
j
, 
k
;

684 
Àvñ
 = ()(
	`log
(
nodes
) /Üog(2.0)) - 1;

685 
GlobÆ_be°
;

687 **
ãmp_föÆ_∑πôi⁄_c‹e
;

688 
ãmp_föÆ_∑πôi⁄_c‹e
 = (**)
	`mÆloc
(4 * (*));

690 
ãmp_föÆ_∑πôi⁄_c‹e
[0] = (*)
	`mÆloc
(
nodes
 * ());

691 
ãmp_föÆ_∑πôi⁄_c‹e
[1] = (*)
	`mÆloc
(
nodes
 * ());

692 
ãmp_föÆ_∑πôi⁄_c‹e
[2] = (*)
	`mÆloc
(
nodes
 * ());

693 
ãmp_föÆ_∑πôi⁄_c‹e
[3] = (*)
	`mÆloc
(
nodes
 * ());

695 *
ãmp_cﬁ
, *
ãmp_row
;

697 
ãmp_row
 = (*)
	`mÆloc
(
nodes
 * (*));

698 
ãmp_cﬁ
 = (*)
	`mÆloc
(
nodes
 * (*));

699 
cuº_lvl
 = 
Àvñ
; curr_lvl > 0; curr_lvl--) {

701 
i
 = 0; i < 
nodes
; i++) {

702 
ãmp_föÆ_∑πôi⁄_c‹e
[0][
i
] =Åemp_final_partition_core[1][i] =

703 
ãmp_föÆ_∑πôi⁄_c‹e
[2][
i
] =Åemp_final_partition_core[3][i] =

704 
föÆ_∑πôi⁄_c‹e
[
i
];

707 
i
 = 0; i < ()
	`pow
(2, 
cuº_lvl
); i = i + 2) {

708 
j
 = 0; j < 
nodes
; j++) {

709 
ãmp_row
[
j
] = 
addªss
.
row
[j];

710 
ãmp_cﬁ
[
j
] = 
addªss
.
cﬁum
[j];

713 
k
 = 0; k < 
nodes
; k++) {

714 i‡(
a
[
cuº_lvl
 - 1][
k
] =
i
 + 1)

717 
t
 = ()
	`pow
(2.0, 
n
 - 
cuº_lvl
);

719 
mö_row
 = 
addªss
.
row
[
k
 - 
t
];

720 
mö_cﬁ
 = 
addªss
.
cﬁum
[
k
 - 
t
];

721 
max_row
 = 
addªss
.
row
[
k
 - 
t
];

722 
max_cﬁ
 = 
addªss
.
cﬁum
[
k
 - 
t
];

724 
w
 = 
k
 - 
t
; w < k; w++) {

725 i‡(
addªss
.
row
[
w
] > 
max_row
)

726 
max_row
 = 
addªss
.
row
[
w
];

728 i‡(
addªss
.
cﬁum
[
w
] > 
max_cﬁ
)

729 
max_cﬁ
 = 
addªss
.
cﬁum
[
w
];

732 
avg_row
 = (
max_row
 + 
mö_row
) / 2.0;

733 
avg_cﬁ
 = (
max_cﬁ
 + 
mö_cﬁ
) / 2.0;

735 
be°_co°
[0] =

736 
	`Êù
(
gøph
, 
ãmp_föÆ_∑πôi⁄_c‹e
[0], 
k
, 
t
, 
nodes
, 
loˇl
);

739 
dif‰í˚
 = (
max_row
 - 
mö_row
) / 2.0;

740 
shi·
 = 
	`˚û
(
dif‰í˚
);

742 
w
 = 
k
 - 
t
; w < k; w++) {

743 i‡(
addªss
.
row
[
w
] >
avg_row
)

744 
addªss
.
row
[
w
] =áddªss.row[w] - 
shi·
;

745 i‡(
addªss
.
row
[
w
] < 
avg_row
)

746 
addªss
.
row
[
w
] =áddªss.row[w] + 
shi·
;

749 
w
 = 0; w < 
nodes
; w++) {

750 
j
 = 0; j < 
nodes
; j++) {

751 i‡(
ãmp_row
[
w
] =
addªss
.
row
[
j
] &&

752 
ãmp_cﬁ
[
w
] =
addªss
.
cﬁum
[
j
]) {

753 
ãmp_föÆ_∑πôi⁄_c‹e
[1][
w
] = 
föÆ_∑πôi⁄_c‹e
[
j
];

759 
j
 = 0; j < 
nodes
; j++) {

760 
addªss
.
row
[
j
] = 
ãmp_row
[j];

761 
addªss
.
cﬁum
[
j
] = 
ãmp_cﬁ
[j];

764 
be°_co°
[1] =

765 
	`Êù
(
gøph
, 
ãmp_föÆ_∑πôi⁄_c‹e
[1], 
k
, 
t
, 
nodes
, 
loˇl
);

769 
dif‰í˚
 = (
max_cﬁ
 - 
mö_cﬁ
) / 2.0;

770 
shi·
 = 
	`˚û
(
dif‰í˚
);

772 
w
 = 
k
 - 
t
; w < k; w++) {

773 i‡(
addªss
.
cﬁum
[
w
] >
avg_cﬁ
)

774 
addªss
.
cﬁum
[
w
] =áddªss.cﬁum[w] - 
shi·
;

775 i‡(
addªss
.
cﬁum
[
w
] < 
avg_cﬁ
)

776 
addªss
.
cﬁum
[
w
] =áddªss.cﬁum[w] + 
shi·
;

779 
w
 = 0; w < 
nodes
; w++) {

780 
j
 = 0; j < 
nodes
; j++) {

781 i‡(
ãmp_row
[
w
] =
addªss
.
row
[
j
] &&

782 
ãmp_cﬁ
[
w
] =
addªss
.
cﬁum
[
j
]) {

783 
ãmp_föÆ_∑πôi⁄_c‹e
[2][
w
] = 
föÆ_∑πôi⁄_c‹e
[
j
];

789 
j
 = 0; j < 
nodes
; j++) {

790 
addªss
.
row
[
j
] = 
ãmp_row
[j];

791 
addªss
.
cﬁum
[
j
] = 
ãmp_cﬁ
[j];

794 
be°_co°
[2] =

795 
	`Êù
(
gøph
, 
ãmp_föÆ_∑πôi⁄_c‹e
[2], 
k
, 
t
, 
nodes
, 
loˇl
);

799 
dif‰í˚
 = (
max_row
 - 
mö_row
) / 2.0;

800 
shi·
 = 
	`˚û
(
dif‰í˚
);

802 
w
 = 
k
 - 
t
; w < k; w++) {

803 i‡(
addªss
.
row
[
w
] >
avg_row
)

804 
addªss
.
row
[
w
] =áddªss.row[w] - 
shi·
;

805 i‡(
addªss
.
row
[
w
] < 
avg_row
)

806 
addªss
.
row
[
w
] =áddªss.row[w] + 
shi·
;

809 
w
 = 0; w < 
nodes
; w++) {

810 
j
 = 0; j < 
nodes
; j++) {

811 i‡(
ãmp_row
[
w
] =
addªss
.
row
[
j
] &&

812 
ãmp_cﬁ
[
w
] =
addªss
.
cﬁum
[
j
]) {

813 
ãmp_föÆ_∑πôi⁄_c‹e
[3][
w
] = 
föÆ_∑πôi⁄_c‹e
[
j
];

819 
j
 = 0; j < 
nodes
; j++) {

820 
addªss
.
row
[
j
] = 
ãmp_row
[j];

821 
addªss
.
cﬁum
[
j
] = 
ãmp_cﬁ
[j];

824 
be°_co°
[3] =

825 
	`Êù
(
gøph
, 
ãmp_föÆ_∑πôi⁄_c‹e
[3], 
k
, 
t
, 
nodes
, 
loˇl
);

829 
GlobÆ_be°
 = 
be°_co°
[0];

831 
be°_∑πôi⁄
 = 0;

832 
j
 = 0; j < 4; j++) {

833 i‡(
GlobÆ_be°
 > 
be°_co°
[
j
]) {

834 
GlobÆ_be°
 = 
be°_co°
[
j
];

835 
be°_∑πôi⁄
 = 
j
;

839 
j
 = 0; j < 
nodes
; j++) {

840 
föÆ_∑πôi⁄_c‹e
[
j
] = 
ãmp_föÆ_∑πôi⁄_c‹e
[
be°_∑πôi⁄
][j];

845 
	`‰ì
(
ãmp_cﬁ
);

846 
	`‰ì
(
ãmp_row
);

847 
	`‰ì
(
ãmp_föÆ_∑πôi⁄_c‹e
);

849 
	}
}

867 
	$Êù
(**
G
, *
föÆ_∑πôi⁄_c‹e
, 
k
, 
t
, 
nodes
,

868 
loˇl
) {

870 
co°_¨r
[4], 
be°_co°
, 
avg_row
, 
avg_cﬁ
, 
dif‰í˚
;

871 i‡(
loˇl
 == 1)

872 
co°_¨r
[0] = 
be°_co°
 =

873 
	`co°_loˇl
(
föÆ_∑πôi⁄_c‹e
, 
G
, 
nodes
, 
k
 - 
t
, k +Å);

874 i‡(
loˇl
 == 0)

875 
co°_¨r
[0] = 
be°_co°
 = 
	`co°
(
föÆ_∑πôi⁄_c‹e
, 
G
, 
nodes
);

877 **
ãmp_föÆ_∑πôi⁄_c‹e
, 
be°
 = 0, 
w
, 
mö_row
, 
max_row
, 
mö_cﬁ
,

878 
max_cﬁ
, 
shi·
, 
j
, *
ãmp_cﬁ
, *
ãmp_row
;

879 
ãmp_föÆ_∑πôi⁄_c‹e
 = (**)
	`mÆloc
(4 * (*));

881 
ãmp_föÆ_∑πôi⁄_c‹e
[0] = (*)
	`mÆloc
(
nodes
 * ());

882 
ãmp_föÆ_∑πôi⁄_c‹e
[1] = (*)
	`mÆloc
(
nodes
 * ());

883 
ãmp_föÆ_∑πôi⁄_c‹e
[2] = (*)
	`mÆloc
(
nodes
 * ());

884 
ãmp_föÆ_∑πôi⁄_c‹e
[3] = (*)
	`mÆloc
(
nodes
 * ());

886 
ãmp_row
 = (*)
	`mÆloc
(
nodes
 * (*));

887 
ãmp_cﬁ
 = (*)
	`mÆloc
(
nodes
 * (*));

888 
j
 = 0; j < 
nodes
; j++) {

889 
ãmp_row
[
j
] = 
addªss
.
row
[j];

890 
ãmp_cﬁ
[
j
] = 
addªss
.
cﬁum
[j];

891 
ãmp_föÆ_∑πôi⁄_c‹e
[0][
j
] = 
föÆ_∑πôi⁄_c‹e
[j];

894 
mö_row
 = 
addªss
.
row
[
k
];

895 
mö_cﬁ
 = 
addªss
.
cﬁum
[
k
];

896 
max_row
 = 
addªss
.
row
[
k
];

897 
max_cﬁ
 = 
addªss
.
cﬁum
[
k
];

898 
w
 = 
k
; w < k + 
t
; w++) {

899 i‡(
addªss
.
row
[
w
] > 
max_row
)

900 
max_row
 = 
addªss
.
row
[
w
];

902 i‡(
addªss
.
cﬁum
[
w
] > 
max_cﬁ
)

903 
max_cﬁ
 = 
addªss
.
cﬁum
[
w
];

905 
avg_cﬁ
 = (
max_cﬁ
 + 
mö_cﬁ
) / 2.0;

906 
avg_row
 = (
max_row
 + 
mö_row
) / 2.0;

910 
dif‰í˚
 = (
max_row
 - 
mö_row
) / 2.0;

911 
shi·
 = 
	`˚û
(
dif‰í˚
);

912 
w
 = 
k
; w < k + 
t
; w++) {

913 i‡(
addªss
.
row
[
w
] >
avg_row
)

914 
addªss
.
row
[
w
] =áddªss.row[w] - 
shi·
;

915 i‡(
addªss
.
row
[
w
] < 
avg_row
)

916 
addªss
.
row
[
w
] =áddªss.row[w] + 
shi·
;

919 
w
 = 0; w < 
nodes
; w++) {

920 
j
 = 0; j < 
nodes
; j++) {

921 i‡(
ãmp_row
[
w
] =
addªss
.
row
[
j
] && 
ãmp_cﬁ
[w] =addªss.
cﬁum
[j]) {

922 
ãmp_föÆ_∑πôi⁄_c‹e
[1][
w
] = 
föÆ_∑πôi⁄_c‹e
[
j
];

930 
j
 = 0; j < 
nodes
; j++) {

931 
addªss
.
row
[
j
] = 
ãmp_row
[j];

932 
addªss
.
cﬁum
[
j
] = 
ãmp_cﬁ
[j];

935 i‡(
loˇl
 == 1)

936 
co°_¨r
[1] =

937 
	`co°_loˇl
(
ãmp_föÆ_∑πôi⁄_c‹e
[1], 
G
, 
nodes
, 
k
 - 
t
, k +Å);

939 
co°_¨r
[1] = 
	`co°
(
ãmp_föÆ_∑πôi⁄_c‹e
[1], 
G
, 
nodes
);

944 
dif‰í˚
 = (
max_cﬁ
 - 
mö_cﬁ
) / 2.0;

945 
shi·
 = 
	`˚û
(
dif‰í˚
);

947 
w
 = 
k
; w < k + 
t
; w++) {

948 i‡(
addªss
.
cﬁum
[
w
] >
avg_cﬁ
)

949 
addªss
.
cﬁum
[
w
] =áddªss.cﬁum[w] - 
shi·
;

950 i‡(
addªss
.
cﬁum
[
w
] < 
avg_cﬁ
)

951 
addªss
.
cﬁum
[
w
] =áddªss.cﬁum[w] + 
shi·
;

954 
w
 = 0; w < 
nodes
; w++) {

955 
j
 = 0; j < 
nodes
; j++) {

956 i‡(
ãmp_row
[
w
] =
addªss
.
row
[
j
] && 
ãmp_cﬁ
[w] =addªss.
cﬁum
[j]) {

957 
ãmp_föÆ_∑πôi⁄_c‹e
[2][
w
] = 
föÆ_∑πôi⁄_c‹e
[
j
];

964 
j
 = 0; j < 
nodes
; j++) {

965 
addªss
.
row
[
j
] = 
ãmp_row
[j];

966 
addªss
.
cﬁum
[
j
] = 
ãmp_cﬁ
[j];

969 i‡(
loˇl
 == 1)

970 
co°_¨r
[2] =

971 
	`co°_loˇl
(
ãmp_föÆ_∑πôi⁄_c‹e
[2], 
G
, 
nodes
, 
k
 - 
t
, k +Å);

973 
co°_¨r
[2] = 
	`co°
(
ãmp_föÆ_∑πôi⁄_c‹e
[2], 
G
, 
nodes
);

977 
dif‰í˚
 = (
max_row
 - 
mö_row
) / 2.0;

978 
shi·
 = 
	`˚û
(
dif‰í˚
);

980 
w
 = 
k
; w < k + 
t
; w++) {

981 i‡(
addªss
.
row
[
w
] >
avg_row
)

982 
addªss
.
row
[
w
] =áddªss.row[w] - 
shi·
;

983 i‡(
addªss
.
row
[
w
] < 
avg_row
)

984 
addªss
.
row
[
w
] =áddªss.row[w] + 
shi·
;

987 
w
 = 0; w < 
nodes
; w++) {

988 
j
 = 0; j < 
nodes
; j++) {

989 i‡(
ãmp_row
[
w
] =
addªss
.
row
[
j
] && 
ãmp_cﬁ
[w] =addªss.
cﬁum
[j]) {

990 
ãmp_föÆ_∑πôi⁄_c‹e
[3][
w
] = 
föÆ_∑πôi⁄_c‹e
[
j
];

997 
j
 = 0; j < 
nodes
; j++) {

998 
addªss
.
row
[
j
] = 
ãmp_row
[j];

999 
addªss
.
cﬁum
[
j
] = 
ãmp_cﬁ
[j];

1002 i‡(
loˇl
 == 1)

1003 
co°_¨r
[3] = 
	`co°_loˇl
(
ãmp_föÆ_∑πôi⁄_c‹e
[3], 
G
, 
nodes
, 
k
 - 
t
, k +Å);

1005 
co°_¨r
[3] = 
	`co°
(
ãmp_föÆ_∑πôi⁄_c‹e
[3], 
G
, 
nodes
);

1009 
j
 = 1; j < 4; j++) {

1010 i‡(
co°_¨r
[
j
] < 
be°_co°
) {

1011 
	`¥ötf
("Co°áº: %.4f\n", 
co°_¨r
[
j
]);

1012 
be°_co°
 = 
co°_¨r
[
j
];

1013 
be°
 = 
j
;

1018 
j
 = 0; j < 
nodes
; j++) {

1019 
föÆ_∑πôi⁄_c‹e
[
j
] = 
ãmp_föÆ_∑πôi⁄_c‹e
[
be°
][j];

1022 
	`‰ì
(
ãmp_cﬁ
);

1023 
	`‰ì
(
ãmp_row
);

1024 
	`‰ì
(
ãmp_föÆ_∑πôi⁄_c‹e
);

1026  
be°_co°
;

1027 
	}
}

	@
1
.
0
4
47
Header.hpp
optical.c
optical.hpp
opticalKL.cpp
